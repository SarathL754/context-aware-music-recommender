# Context-Aware Music Recommender

A research project that combines **Knowledge Graphs** and **Reinforcement Learning** to build a mood-based music recommendation system.

## Overview

This project was developed as part of the Summer Research Program 2025 at the University of North Texas (UNT).

It presents a novel approach to context-aware music recommendation by combining Knowledge Graphs (KGs) and Reinforcement Learning (RL). The system models structured relationships between users, moods, and songs—where moods are inferred using zero-shot classification from a large language model (Mistral-7B). A reinforcement learning agent is then trained to traverse the knowledge graph, generating personalized and explainable music recommendations that align with user mood and context.

## Features

- **Knowledge Graph Construction**: Model entities like songs, artists, moods, and their relationships.
- **Context Awareness**: Incorporate user mood and context for personalized recommendations.
- **Reinforcement Learning**: Learn optimal recommendation strategies through user feedback.
- **Data Exploration**: Jupyter Notebooks for interactive analysis and experimentation.

## Tech Stack

- **Jupyter Notebook** (100%)
- Python (recommended for graph and RL libraries such as NetworkX, PyTorch, etc.)
- Knowledge Graph libraries (e.g., RDFLib, NetworkX)
- Reinforcement Learning frameworks (e.g., stable-baselines3, OpenAI Gym)

## Getting Started

1. **Clone the repository:**
   ```bash
   git clone https://github.com/SarathL754/context-aware-music-recommender.git
   cd context-aware-music-recommender
   ```

2. **Set up the environment:**
   - It is recommended to use a virtual environment:
     ```bash
     python -m venv venv
     source venv/bin/activate  # On Windows: venv\Scripts\activate
     ```
   - Install dependencies (add your requirements to `requirements.txt`):
     ```bash
     pip install -r requirements.txt
     ```

3. **Open the notebooks:**
   - Launch Jupyter Lab or Notebook:
     ```bash
     jupyter lab
     # or
     jupyter notebook
     ```

## Usage

- Run and explore the Jupyter Notebooks for:
  - Knowledge graph creation and visualization
  - Mood/contextual data modeling
  - Reinforcement learning experiments for recommendation

## Example
### Song labels
Zero-shot prompt designed for Mistral-7B to classify song lyrics into one of four predefined mood categories. The model is instructed to return only the most suitable mood enclosed within [ANS] tags for consistent parsing
<img width="1298" height="358" alt="image" src="https://github.com/user-attachments/assets/ebc8ae5c-95d1-4284-9c72-cba8ec99a36f" />

Distribution of Predicted Mood Labels from Mistral-7B
The majority of lyrics were classified as Uplifting and motivational, followed by Sadness or melancholy. Few tracks were labeled as Social gatherings or parties, and a small number were marked as unknown due to ambiguous or empty lyrics.
<img width="1516" height="911" alt="image" src="https://github.com/user-attachments/assets/9db8e480-4282-4fbe-b904-dd935811c153" />


### Knowledge Graph
<img width="957" height="823" alt="image" src="https://github.com/user-attachments/assets/be6cad23-ae94-4020-8acf-fa62a7de4e47" />
Sample subgraph from the full Knowledge Graph (KG), showing connections between users, moods, and songs. The graph captures 2-hop paths like User → Mood → Song, forming the environment for the RL agent to traverse. Nodes are color-coded and labeled for interpretability.



### Reinforcement Learning
Below is a snippet showing the initialization of the Deep Q-Network (DQN) agent using `stable-baselines3`. The agent learns to traverse the Knowledge Graph using a policy that maximizes mood-aligned song recommendations.
<img width="1218" height="145" alt="image" src="https://github.com/user-attachments/assets/776e5767-e334-4936-b3f4-1804c3284875" />

Below are example recommendation paths generated by the trained DQN agent. Each row represents a 2-hop traversal from a user node → mood → song node, resulting in an interpretable, mood-aligned recommendation.

| User (Start)       | Mood (Hop 1)                 | Song ID (Hop 2)          | Song Name  |
| ------------------ | ---------------------------- | ------------------------ | ---------- |
| `user_60+_Female`  | Relaxation and stress relief | `3RWK6mtkk0RQCuARdfql4x` | Circles    |
| `user_6-12_Others` | Social gatherings or parties | `7yf4xEjb6zplbk13JF2hQC` | Big Up     |
| `user_20-35_Male`  | Uplifting and motivational   | `4MtGjAHHh3pSvJPaDltuhm` | James Bond |




## Project Structure

```
context-aware-music-recommender/
├── notebooks/
│   ├── main.ipynb
│   └── song_lyrics.ipynb
├── data/
│   ├── lyrics_10k.csv
│   └── Spotify_data.xlsx
├── requirements.txt
└── README.md

```

## Contributing

Contributions are welcome! Please open an issue or submit a pull request.

## Author

[SarathL754](https://github.com/SarathL754)
